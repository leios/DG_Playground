<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Discontinuous Galerkin · DG_Playground</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">DG_Playground</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Discontinuous Galerkin</a><ul class="internal"><li><a class="tocitem" href="#Single-Element-Equation-1"><span>Single Element Equation</span></a></li></ul></li><li><a class="tocitem" href="../convective_adjustment/">Convective Adjustment</a></li><li><a class="tocitem" href="../function_index/">Function Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Discontinuous Galerkin</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Discontinuous Galerkin</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sandreza/DG_Playground/blob/master/docs/src/dg_methods.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Discontinuous-Galerkin-1"><a class="docs-heading-anchor" href="#Discontinuous-Galerkin-1">Discontinuous Galerkin</a><a class="docs-heading-anchor-permalink" href="#Discontinuous-Galerkin-1" title="Permalink"></a></h1><p>In <a href="https://github.com/CliMA/ClimateMachine.jl">CLIMA</a> the <a href="https://en.wikipedia.org/wiki/Discontinuous_Galerkin_method">Discontinuous Galerkin</a> method serves as our spatial discretization method. It may be thought of as a combination of spectral methods and finite volume methods. The method is a higher-order generalization of a finite volume method.</p><h2 id="Single-Element-Equation-1"><a class="docs-heading-anchor" href="#Single-Element-Equation-1">Single Element Equation</a><a class="docs-heading-anchor-permalink" href="#Single-Element-Equation-1" title="Permalink"></a></h2><p>Our goal will be to understand the Discontinuous Galerkin (DG) discretization for a single element.  We will use this to illustrate the role of boundary fluxes but also to understand differences with finite volume codes. To better illustrate the discrete implementation of the weak formulation of the conservation equation, we consider the advection-diffusion equation</p><div>\[\begin{aligned}
    \partial_t \rho + \partial_x \left( u \rho \right) &amp;= \partial_x \sigma \\
    \sigma &amp;= \partial_x \rho
\end{aligned}\]</div><p>where <span>$u \in \mathbb{R}$</span>, the domain is <span>$x \in (-1,  1) \equiv \Omega = E$</span>, and <span>$\rho(x,t)$</span> and/or <span>$\sigma(x,t)$</span> satisfies some prescribed boundary conditions.</p><h3 id="Weak-Form-1"><a class="docs-heading-anchor" href="#Weak-Form-1">Weak Form</a><a class="docs-heading-anchor-permalink" href="#Weak-Form-1" title="Permalink"></a></h3><p>The weak form of the equations is obtained by multiplying through each equation by <em>test functions</em> <span>$\psi(x)$</span> , <span>$\varphi(x)$</span>, integrating over the domain, and integrating by parts on the terms with derivatives, to obtain</p><div>\[\begin{aligned}
    \partial_t \int_E \psi \rho - \int_E  (\partial_x \psi) (u \rho) &amp;=
    - \int_E (\partial_x \psi) \sigma
    + \int_{\partial E} \psi \sigma - \int_{\partial E}  \psi (u \rho)
    \\
    \int_E \varphi \sigma &amp;= - \int_{E} (\partial_x \varphi) \rho + \int_{\partial E } \varphi \rho
\end{aligned}\]</div><p>The terms on the boundary are interpreted as numerical fluxes, typically denoted by an asterisk as follows</p><div>\[\begin{aligned}
    \partial_t \int_E \psi \rho - \int_E  (\partial_x \psi) (u \rho) &amp;=
    - \int_E (\partial_x \psi) \sigma
    + \int_{\partial E} \psi \sigma^* - \int_{\partial E}  \psi (u \rho)^*
    \\
    \int_E \varphi \sigma &amp;= - \int_{E} (\partial_x \varphi) \rho + \int_{\partial E } \varphi \rho^*
\end{aligned}\]</div><p>This form is taken as the definition of our partial differential equation in <em>weak form</em>.</p><h3 id="Discontinuous-Galerkin-Approximation-1"><a class="docs-heading-anchor" href="#Discontinuous-Galerkin-Approximation-1">Discontinuous Galerkin Approximation</a><a class="docs-heading-anchor-permalink" href="#Discontinuous-Galerkin-Approximation-1" title="Permalink"></a></h3><p>In DG we approximate the spatial structure of our functions <span>$\rho(x,t)$</span> and <span>$\sigma(x,t)$</span> by a set of linearly independent polynomials, <span>$\ell_i(x)$</span> for <span>$i = 0, ..., N$</span>, within each element, so that</p><div>\[\begin{aligned}
    \rho(x,t) = \rho_i(t) \ell_i(x) \text{ and } \sigma(x,t) = \sigma_i(t) \ell_i(x)
\end{aligned}\]</div><p>where we are using Einstein summation convention for repeated indices. To reduce notational clutter we will occasionally suppress the <span>$x$</span>-dependence and <span>$t$</span>-dependence in the following manner</p><div>\[\begin{aligned}
    \rho = \rho_i \ell_i \text{ and } \sigma = \sigma_i \ell_i.
\end{aligned}\]</div><p>We have <span>$2(N+1)$</span> degrees of freedom (<span>$N+1$</span> for <span>$\rho_i$</span> and <span>$N+1$</span> for <span>$\sigma_i$</span>), thus we must specify <span>$2(N+1)$</span> test functions for which we are satisfying the equation. In the Galerkin method we take the test functions to be the same as the basis in which we are representing our solution, i.e., <span>$\psi = \ell_i(x)$</span> for <span>$i = 0,..., N$</span> and <span>$\varphi = \ell_j(x)$</span> for <span>$j = 0, ... ,$</span>.</p><p>In index notation and with Einstein summation convection, equations become (basically just replacing <span>$\psi = \varphi = \ell_i$</span> and <span>$\rho = \rho_j \ell_j$</span> and <span>$\sigma = \sigma_j \ell_j$</span>)</p><div>\[\begin{aligned}
    \partial_t \int_E \ell_i \ell_j \rho_j - \int_E  \ell_i&#39; \ell_j (u \rho_j) &amp;=
    - \int_E \ell_i&#39; \ell_j \sigma_j
    + \int_{\partial E} \ell_i \sigma^* - \int_{\partial E}  \ell_i  (u \rho)^*
    \\
    \int_E \ell_i \ell_j \sigma_j &amp;= - \int_{E} \ell_i&#39; \ell_j \rho_j + \int_{\partial E } \ell_i \rho^*,
\end{aligned}\]</div><p>where we have introduced the prime notation to denote a derivative, e.g., <span>$\ell_i&#39;$</span> denotes the derivative of <span>$\ell_i$</span>. We see that a few operators come up over and over again, and they are given special names. The operator whose entries are given by</p><div>\[\begin{aligned}
    \mathcal{M}_{ij} = \int_{E} \ell_i \ell_j,
\end{aligned}\]</div><p>is known as the <em>mass matrix</em>, a name borrowed from the finite element community. The operator whose entries are given by</p><div>\[\begin{aligned}
    \mathcal{S}_{ji} = \int_{E} \ell_i&#39; \ell_j,
\end{aligned}\]</div><p>is known as the <em>stiffness matrix</em> a name also borrowed from the finite element community. The flipping of the indices on the entries of <span>$\mathcal{S}$</span> is purposeful and corresponds to how it is ``usually&quot; defined.</p><p>The boundary operators become</p><div>\[\begin{aligned}
    \int_{\partial E } \ell_i \rho^* = \ell_i(1) \rho^*(1) - \ell_i(-1) \rho^*(-1)
\end{aligned}\]</div><p>and similarly for the other terms. We are abbreviating <span>$\rho^*(x = 1, t)$</span> as <span>$\rho^*(1)$</span> and we will do so for other variables as well. The boundary terms are especially relevant since they play pivotal role in how one formulates boundary conditions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../convective_adjustment/">Convective Adjustment »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 19 June 2020 23:44">Friday 19 June 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
